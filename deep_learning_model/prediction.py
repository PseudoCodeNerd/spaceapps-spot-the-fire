# -*- coding: utf-8 -*-
"""Prediction.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1RqT3xX6AE9VDE7J-EZq2fy4K1Pu9wzHt
"""

!wget --no-parent -r https://neo.sci.gsfc.nasa.gov/archive/rgb/MOD_NDVI_16/
!wget --no-parent -r https://neo.sci.gsfc.nasa.gov/archive/rgb/MOD14A1_E_FIRE/
!wget --no-parent -r https://neo.sci.gsfc.nasa.gov/archive/rgb/MODAL2_E_AER_OD/
!wget --no-parent -r https://neo.sci.gsfc.nasa.gov/archive/rgb/MODAL2_E_SKY_WV/ 
!wget --no-parent -r https://neo.sci.gsfc.nasa.gov/archive/rgb/MOD_LSTN_E/

import cv2
import numpy as np
from google.colab.patches import cv2_imshow
import os
import pickle

folder = "/content/neo.sci.gsfc.nasa.gov/archive/rgb/MODAL2_E_SKY_WV"

filenames = []

for filename in os.listdir(folder):
    filenames.append(filename)

filenames.sort()

for i in range(4):
  images = []
  upper_limit = min((i+1)*250, len(filenames))
  subset = filenames[i*250:upper_limit]

  for filename in subset:
    print(os.path.join(folder,filename))
    image = cv2.imread(os.path.join(folder,filename))
    if image is not None:
        image = cv2.resize(image, (1440,720), interpolation = cv2.INTER_AREA)
        pimage = image.sum(axis=2)
        pimage = pimage / pimage.max()
        images.append(pimage)
        images.append(pimage)


  with open("/content/drive/My Drive/NASA SpaceApps/data/water" + str(i) + ".pkl", 'wb') as f:
    pickle.dump(images, f)

with open('vegetation4.pkl', 'wb') as f:
  pickle.dump(images, f)

color.sum(axis=2)



def find_color(rgb):
  matches = np.where(np.all(color[0]==rgb,axis=1))
  try:
    if len(matches[0]):
      return int(matches[0][0])
  except: 
    print ('ERROR', matches)
  return None
find_color([ 76, 181, 254])

pimage = image.sum(axis=2)
pimage = pimage / pimage.max()
savetxt('data.csv', pimage, delimiter=',')

pimage.min()

pimage.max()

from keras.optimizers import Adamax

Adamax(learning_rate=0.005)